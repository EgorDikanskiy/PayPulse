import React, { useState, useEffect } from 'react';
import { useDispatch, useSelector } from 'react-redux';
import { AppDispatch, RootState } from 'store';
import styles from './Search.module.scss';

const Search = () => {
  const dispatch = useDispatch<AppDispatch>();
  const allGenres = useSelector((state: RootState) => state.catalog.allGenres);
  const [searchTerm, setSearchTerm] = useState<string>('');
  const [typingTimeout, setTypingTimeout] = useState<NodeJS.Timeout | null>(null);

  // const handleSearch = (term: string) => {
  //   dispatch(getBooks({ title: term }));
  // };

  // const handleIsFiltersOpen = () => {
  //   if (allGenres.length === 0) {
  //     dispatch(getGenres());
  //   }
  //   dispatch(toggleFilters(true));
  // };

  // const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {
  //   const value = e.target.value;
  //   setSearchTerm(value);

  //   if (typingTimeout) clearTimeout(typingTimeout);

  //   const timeout = setTimeout(() => {
  //     handleSearch(value);
  //   }, 500);

  //   setTypingTimeout(timeout);
  // };

  useEffect(() => {
    return () => {
      if (typingTimeout) clearTimeout(typingTimeout);
    };
  }, [typingTimeout]);

  return (
    <div className={styles.search}>
      <input className={styles.search__input} placeholder="Найти" value={searchTerm} onChange={handleInputChange} />
      <div className={styles.search__lupa}>
        <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M8.9001 9.5L5.7501 6.35C5.5001 6.55 5.2126 6.70833 4.8876 6.825C4.5626 6.94167 4.21676 7 3.8501 7C2.94176 7 2.1731 6.68533 1.5441 6.056C0.915098 5.42667 0.600431 4.658 0.600098 3.75C0.599765 2.842 0.914431 2.07333 1.5441 1.444C2.17376 0.814667 2.94243 0.5 3.8501 0.5C4.75776 0.5 5.5266 0.814667 6.1566 1.444C6.7866 2.07333 7.1011 2.842 7.1001 3.75C7.1001 4.11667 7.04176 4.4625 6.9251 4.7875C6.80843 5.1125 6.6501 5.4 6.4501 5.65L9.6001 8.8L8.9001 9.5ZM3.8501 6C4.4751 6 5.00643 5.78133 5.4441 5.344C5.88176 4.90667 6.10043 4.37533 6.1001 3.75C6.09976 3.12467 5.8811 2.5935 5.4441 2.1565C5.0071 1.7195 4.47576 1.50067 3.8501 1.5C3.22443 1.49933 2.69326 1.71817 2.2566 2.1565C1.81993 2.59483 1.6011 3.126 1.6001 3.75C1.5991 4.374 1.81793 4.90533 2.2566 5.344C2.69526 5.78267 3.22643 6.00133 3.8501 6Z"
            fill="#303030"
            fillOpacity="0.2"
          />
        </svg>
      </div>
      <div className={styles.search__filters}>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect width="24" height="24" rx="8" fill="#A891FF" />
          <path
            d="M10.48 8.61878C10.3474 8.61878 10.2202 8.67146 10.1264 8.76523C10.0327 8.85899 9.97998 8.98617 9.97998 9.11878C9.97998 9.25139 10.0327 9.37856 10.1264 9.47233C10.2202 9.5661 10.3474 9.61878 10.48 9.61878C10.6126 9.61878 10.7398 9.5661 10.8335 9.47233C10.9273 9.37856 10.98 9.25139 10.98 9.11878C10.98 8.98617 10.9273 8.85899 10.8335 8.76523C10.7398 8.67146 10.6126 8.61878 10.48 8.61878ZM9.06498 8.61878C9.16828 8.32601 9.35985 8.0725 9.61328 7.89317C9.86671 7.71385 10.1695 7.61755 10.48 7.61755C10.7904 7.61755 11.0933 7.71385 11.3467 7.89317C11.6001 8.0725 11.7917 8.32601 11.895 8.61878H15.48C15.6126 8.61878 15.7398 8.67146 15.8335 8.76523C15.9273 8.85899 15.98 8.98617 15.98 9.11878C15.98 9.25139 15.9273 9.37856 15.8335 9.47233C15.7398 9.5661 15.6126 9.61878 15.48 9.61878H11.895C11.7917 9.91155 11.6001 10.1651 11.3467 10.3444C11.0933 10.5237 10.7904 10.62 10.48 10.62C10.1695 10.62 9.86671 10.5237 9.61328 10.3444C9.35985 10.1651 9.16828 9.91155 9.06498 9.61878H8.47998C8.34737 9.61878 8.2202 9.5661 8.12643 9.47233C8.03266 9.37856 7.97998 9.25139 7.97998 9.11878C7.97998 8.98617 8.03266 8.85899 8.12643 8.76523C8.2202 8.67146 8.34737 8.61878 8.47998 8.61878H9.06498ZM13.48 11.6188C13.3474 11.6188 13.2202 11.6715 13.1264 11.7652C13.0327 11.859 12.98 11.9862 12.98 12.1188C12.98 12.2514 13.0327 12.3786 13.1264 12.4723C13.2202 12.5661 13.3474 12.6188 13.48 12.6188C13.6126 12.6188 13.7398 12.5661 13.8335 12.4723C13.9273 12.3786 13.98 12.2514 13.98 12.1188C13.98 11.9862 13.9273 11.859 13.8335 11.7652C13.7398 11.6715 13.6126 11.6188 13.48 11.6188ZM12.065 11.6188C12.1683 11.326 12.3598 11.0725 12.6133 10.8932C12.8667 10.7139 13.1695 10.6176 13.48 10.6176C13.7904 10.6176 14.0933 10.7139 14.3467 10.8932C14.6001 11.0725 14.7917 11.326 14.895 11.6188H15.48C15.6126 11.6188 15.7398 11.6715 15.8335 11.7652C15.9273 11.859 15.98 11.9862 15.98 12.1188C15.98 12.2514 15.9273 12.3786 15.8335 12.4723C15.7398 12.5661 15.6126 12.6188 15.48 12.6188H14.895C14.7917 12.9115 14.6001 13.1651 14.3467 13.3444C14.0933 13.5237 13.7904 13.62 13.48 13.62C13.1695 13.62 12.8667 13.5237 12.6133 13.3444C12.3598 13.1651 12.1683 12.9115 12.065 12.6188H8.47998C8.34737 12.6188 8.2202 12.5661 8.12643 12.4723C8.03266 12.3786 7.97998 12.2514 7.97998 12.1188C7.97998 11.9862 8.03266 11.859 8.12643 11.7652C8.2202 11.6715 8.34737 11.6188 8.47998 11.6188H12.065ZM10.48 14.6188C10.3474 14.6188 10.2202 14.6715 10.1264 14.7652C10.0327 14.859 9.97998 14.9862 9.97998 15.1188C9.97998 15.2514 10.0327 15.3786 10.1264 15.4723C10.2202 15.5661 10.3474 15.6188 10.48 15.6188C10.6126 15.6188 10.7398 15.5661 10.8335 15.4723C10.9273 15.3786 10.98 15.2514 10.98 15.1188C10.98 14.9862 10.9273 14.859 10.8335 14.7652C10.7398 14.6715 10.6126 14.6188 10.48 14.6188ZM9.06498 14.6188C9.16828 14.326 9.35985 14.0725 9.61328 13.8932C9.86671 13.7139 10.1695 13.6176 10.48 13.6176C10.7904 13.6176 11.0933 13.7139 11.3467 13.8932C11.6001 14.0725 11.7917 14.326 11.895 14.6188H15.48C15.6126 14.6188 15.7398 14.6715 15.8335 14.7652C15.9273 14.859 15.98 14.9862 15.98 15.1188C15.98 15.2514 15.9273 15.3786 15.8335 15.4723C15.7398 15.5661 15.6126 15.6188 15.48 15.6188H11.895C11.7917 15.9115 11.6001 16.1651 11.3467 16.3444C11.0933 16.5237 10.7904 16.62 10.48 16.62C10.1695 16.62 9.86671 16.5237 9.61328 16.3444C9.35985 16.1651 9.16828 15.9115 9.06498 15.6188H8.47998C8.34737 15.6188 8.2202 15.5661 8.12643 15.4723C8.03266 15.3786 7.97998 15.2514 7.97998 15.1188C7.97998 14.9862 8.03266 14.859 8.12643 14.7652C8.2202 14.6715 8.34737 14.6188 8.47998 14.6188H9.06498Z"
            fill="white"
          />
        </svg>
      </div>
    </div>
  );
};

export default Search;
